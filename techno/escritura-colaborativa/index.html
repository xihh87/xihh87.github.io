<!doctype html><html lang=es-mx><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>C√≥mo montar un servidor de escritura colaborativa.</title>
<link rel=stylesheet media=screen href=https://joshua.haase.mx/css/theme.min.2ee1317322f9eb9b2ef0a618d19b20e38c11f5f9c310751400a45db225dd2626.css integrity="sha256-LuExcyL565su8KYY0Zsg44wR9fnDEHUUAKRdsiXdJiY="></head><body><main><article><h1>C√≥mo montar un servidor de escritura colaborativa.</h1><nav id=TableOfContents><ul><li><a href=#enlaces-interesantes-para-inspiraci√≥n>Enlaces interesantes para inspiraci√≥n</a></li><li><a href=#hedgedoc-pierde-mis-notas-al-reiniciar>Hedgedoc pierde mis notas al reiniciar</a></li><li><a href=#intent√©-colaborar-usando-hedgedoc-y-markdown>Intent√© colaborar usando hedgedoc y markdown</a></li></ul></nav><p><a href=https://www.abemposta.com/posts/selfhosted-overleaf-ansible/ target=_blank rel=noopener>Es posible generar una instancia auto-gestionada de OverLeaf</a>
y <a href=https://github.com/abemposta/ansible-overleaf title="C√≥digo para levantar instancia de Overleaf en tu servidor." target=_blank rel=noopener>Adri√°n Martinez comparti√≥ el c√≥digo</a>.
<a href=https://github.com/overleaf/docker-image target=_blank rel=noopener>El repositorio oficial de Overleaf tiene instrucciones archivadas</a>.</p><p>Yo prefiero escribir con <a href=https://pandoc.org/MANUAL.html target=_blank rel=noopener>pandoc</a> y <a href=https://manubot.org/ target=_blank rel=noopener>manubot</a>,
por lo que favorezco <a href=https://hedgedoc.org/ target=_blank rel=noopener>HedgeDoc</a>.
<a href=https://docs.hedgedoc.org/configuration/ target=_blank rel=noopener>La configuraci√≥n de HedgeDoc para <code>docker</code> se puede encontrar en su sitio oficial</a>.</p><p>Tambi√©n est√° padre que <a href=http://svmiller.com/blog/2016/02/svm-r-markdown-manuscript/ target=_blank rel=noopener>se puede usar Rmarkdown para presentar resultados</a>,
y <a href=https://www.r-bloggers.com/2019/08/rmarkdown-template-that-manages-academic-affiliations-docx-or-pdf-output/ target=_blank rel=noopener>se puede modificar la plantilla de LaTeX para mostrar afiliaciones</a>,
adem√°s <a href=https://github.com/pandoc-scholar/pandoc-scholar target=_blank rel=noopener>existen varios plugins para <code>pandoc</code> que se encargan de los metadatos</a>.</p><p>Como ejemplo para adaptar una plantilla de Rmarkdown a un paper
<a href=https://github.com/jooyoungseo/edmdown target=_blank rel=noopener><code>emdown</code> replica el Journal of Educational Dat mining</a>
y podr√≠a usarse de inspiraci√≥n para adaptar al formato de otras revistas.</p><p><a href=http://pierog.it/en/2018/03/markdown-workflow/ target=_blank rel=noopener>Este flujo de trabajo es similar al que yo uso</a>.</p><h2 id=enlaces-interesantes-para-inspiraci√≥n><a href=#enlaces-interesantes-para-inspiraci%c3%b3n alt>Enlaces interesantes para inspiraci√≥n</a> <a href=# alt="Regresar al inicio">‚Üë</a></h2><p>Si quisiera hacer una aplicaci√≥n que permita escritura colaborativa
revisar√≠a el c√≥digo de <a href=https://github.com/hedgedoc/hedgedoc target=_blank rel=noopener>Hedgedoc</a>,
<a href=https://medevel.com/10-open-source-self-hosted-collaborative-document-editors/ target=_blank rel=noopener>tal vez le dar√≠a una vuelta a estas aplicaciones</a>
y <a href=https://deepai.org/publication/open-source-projects-and-their-collaborative-development-workflows target=_blank rel=noopener>estos flujos de trabajo</a>.</p><p><a href=https://jisajournal.springeropen.com/articles/10.1186/s13174-021-00142-x target=_blank rel=noopener>Herramienta para analizar construcci√≥n de conocimiento colectiva</a>.</p><p>Hay <a href=https://gitlab.com/emacsomancer/collaborative-writing-environment-emacs target=_blank rel=noopener>sistemas para colaborar desde emacs</a>.</p><p>Este sistema <a href=https://ekothe.github.io/trackdown/articles/trackdown-workflow.html target=_blank rel=noopener>sincroniza entre Google Docs y git</a></p><p><a href=https://brainbaking.com/post/2021/02/writing-academic-papers-in-markdown/ target=_blank rel=noopener>Inspiraci√≥n para escribir papers</a>.</p><h2 id=hedgedoc-pierde-mis-notas-al-reiniciar><a href=#hedgedoc-pierde-mis-notas-al-reiniciar alt>Hedgedoc pierde mis notas al reiniciar</a> <a href=# alt="Regresar al inicio">‚Üë</a></h2><p>Mi <a href=https://pad.haase.mx/ target=_blank rel=noopener>hedgedoc</a>
(<a href=https://github.com/xihh87/lbustio.com/blob/master/svc/escritura-colaborativa/compose.yml target=_blank rel=noopener>config</a>)
pierde todos los mensajes al reiniciar.</p><p>Investigando en el servidor encontr√© que es porque
no configur√© bien <code>FILE__DB_HOST</code>
y entonces usa sqlite para guardar las notas.</p><p>Me di cuenta porque <a href=https://dba.stackexchange.com/questions/1285/how-do-i-list-all-databases-and-tables-using-psql target=_blank rel=noopener>la base de datos no ten√≠a registros</a>
y entonces entr√© a la aplicaci√≥n a revisar <code>/app/hedgedoc/config.json</code> que dec√≠a:</p><pre tabindex=0><code>    &#34;test&#34;: {
        &#34;db&#34;: {
            &#34;dialect&#34;: &#34;sqlite&#34;,
            &#34;storage&#34;: &#34;:memory:&#34;
        },
        &#34;linkifyHeaderStyle&#34;: &#34;gfm&#34;
    },
</code></pre><p>Revisando los logs, encontr√© la causa del problema:</p><pre tabindex=0><code>app-1  | [env-init] cannot find secret in FILE__DB_HOST
app-1  | [env-init] DB_NAME set from FILE__DB_NAME
app-1  | [env-init] DB_PASS set from FILE__DB_PASS
app-1  | [env-init] DB_USER set from FILE__DB_USER
</code></pre><p>Pero me hubiera gustado que esto ocasionara una falla en cargar el servicio,
de manera que hubiera tenido que solucionarlo en vez de tener una app funcional
que pierde todas mis notas al reiniciar el servicio.</p><p>Al intentar solucionar el problema,
me di cuenta de que <a href=https://hub.docker.com/r/linuxserver/hedgedoc target=_blank rel=noopener>la imagen de docker que uso</a> s√≥lo puede usar mysql como servidor externo,
mi primera aproximaci√≥n fue intentar <a href=https://quay.io/repository/hedgedoc/hedgedoc target=_blank rel=noopener>usar la imagen oficial</a>,
pero dado que <a href=https://docs.hedgedoc.org/setup/docker/ target=_blank rel=noopener>no soporta pasar los secretos como secretos</a>,
tuve que <a href=https://github.com/linuxserver/docker-hedgedoc/pull/42 target=_blank rel=noopener>cambiar el script de arranque para ser compatible con la variable <code>CMD_DB_DIALECT</code></a>.</p><h2 id=intent√©-colaborar-usando-hedgedoc-y-markdown><a href=#intent%c3%a9-colaborar-usando-hedgedoc-y-markdown alt>Intent√© colaborar usando hedgedoc y markdown</a> <a href=# alt="Regresar al inicio">‚Üë</a></h2><ul><li><p>‚òë <a href=https://gitlab.com/gcd-investigacion/pass/-/issues/9 target=_blank rel=noopener>Descripci√≥n del trabajo</a></p></li><li><p>‚òë Aplicar los cambios en ~/xihh/proyectos/taller-del-hacker-√©tico/mejoras-para-el-taller.md
para tener un sistema de escritura colaborativo.</p></li><li><p>‚òë Generar un sistema para compilar un manuscrito con plantillas.</p><ul><li><p>‚òë Generar una imagen de docker con todas mis dependencias.</p><p><code>cr server</code></p></li><li><p>‚òë Instalar 9base</p><ul><li><p>üóµ Agregar repos edge o testing.</p></li><li><p>‚òë <a href=https://wiki.alpinelinux.org/wiki/Alpine_Linux_package_management#Repository_pinning target=_blank rel=noopener>Instalar el paquete desde testing</a>:</p><pre tabindex=0><code>apk add --update --no-cache --repository http://dl-3.alpinelinux.org/alpine/edge/testing/ 9base
</code></pre></li><li><p>‚òë Agregar plantillas que utilizo.</p><ul><li>eisvogel</li><li>default + metropolis-theme</li></ul></li></ul></li><li><p>‚òë Subirla al repositorio</p><p><code>cr server</code> (commit 595048dc)</p></li><li><p>‚òë <del>Tomar la plantilla que tengo en <code>cr doct</code> como base.</del></p><p>Tomar la plantilla <code>eisvogel</code> como base para documentos Ibero,
consultar detalles en:</p><p>${HOME}/xihh/proyectos/generar-plantilla-ibero.md</p></li><li><p>‚òë configurar un repo para usar la imagen de construcci√≥n.</p><p><code>cr seg</code> (e2089e3)</p></li><li><p>‚òë Construir las presentaciones autom√°ticamente</p><pre tabindex=0><code>env TEXMFCACHE=cache pandoc -f markdown+grid_tables+table_captions+pipe_tables+example_lists+fenced_code_attributes+fenced_divs+bracketed_spans+footnotes --data-dir=/usr/share/pandoc/data --template=eisvogel --filter=pandoc-manubot-cite --citeproc --pdf-engine=lualatex --slide-level=2 -o gu√≠a.t.pdf gu√≠a.md
</code></pre></li></ul></li></ul><p>El sistema tiene por una parte el <a href=https://pad.haase.mx/ target=_blank rel=noopener>pad</a>
donde se puede colaborar (que ya no perder√° los datos al reiniciar),
y un <a href=https://gitlab.com/xihh87/pandoc-build-server/ target=_blank rel=noopener>contenedor para transformar markdown a pdf</a>,
junto con <a href=https://gitlab.com/xihh87/ppt target=_blank rel=noopener>esta plantilla para construir los archivos</a>.</p><p>Uno de mis intentos de colaboraci√≥n fall√≥ porque los documentos se perd√≠an sin aviso.
Ese problema ya est√° resuelto.</p><p>Otro de los problemas es que no les gustaba usar gitlab,
pero tal vez con el editor nuevo basado en vscode web funcione.</p></article></main></body></html>