<!doctype html><html lang=es-mx><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Firewall</title>
<link rel=stylesheet media=screen href=https://joshua.haase.mx/css/theme.min.2ee1317322f9eb9b2ef0a618d19b20e38c11f5f9c310751400a45db225dd2626.css integrity="sha256-LuExcyL565su8KYY0Zsg44wR9fnDEHUUAKRdsiXdJiY="><script src=https://hypothes.is/embed.js></script></head><body><main><article><h1>Firewall</h1><nav id=TableOfContents></nav><p>Para hacer un firewall en tu infraestructura podrías usar <code>nft</code>.</p><p><a href=https://wiki.nftables.org/wiki-nftables/index.php/Performing_Network_Address_Translation_%28NAT%29 target=_blank rel=noopener>https://wiki.nftables.org/wiki-nftables/index.php/Performing_Network_Address_Translation_(NAT)</a></p><p><a href=https://unix.stackexchange.com/questions/555465/port-forwarding-nat-with-nftables target=_blank rel=noopener>https://unix.stackexchange.com/questions/555465/port-forwarding-nat-with-nftables</a></p><p><a href=https://www.ssh.com/ssh/tunneling/example target=_blank rel=noopener>https://www.ssh.com/ssh/tunneling/example</a></p><p><a href=https://wiki.archlinux.org/index.php/Nftables target=_blank rel=noopener>https://wiki.archlinux.org/index.php/Nftables</a></p><p><a href=https://www.haproxy.org/ target=_blank rel=noopener>https://www.haproxy.org/</a></p><p><a href=https://linux-audit.com/nftables-beginners-guide-to-traffic-filtering/ target=_blank rel=noopener>https://linux-audit.com/nftables-beginners-guide-to-traffic-filtering/</a></p><p><a href=https://wiki.nftables.org/wiki-nftables/index.php/Logging_traffic target=_blank rel=noopener>https://wiki.nftables.org/wiki-nftables/index.php/Logging_traffic</a></p><hr><p>Quiero configurar un firewall para las siguientes reglas:</p><ul><li><input disabled type=checkbox> Permitir entrada al puerto 22</li><li><input disabled type=checkbox> Redirigir puertos 80 y 443 a 10.0.0.11</li><li><input disabled type=checkbox> Redirigir puerto 22210 a 10.10.0.146 22</li></ul><hr><pre tabindex=0><code>sudo nft add table inet my_table
sudo nft add chain inet my_table my_input &#39;{ type filter hook input priority 0 ; policy drop ; }&#39;
sudo nft add chain inet my_table my_forward &#39;{ type filter hook forward priority 0 ; policy drop ; }&#39;
sudo nft add chain inet my_table my_output &#39;{ type filter hook output priority 0 ; policy accept ; }&#39;
# Allow administration port
sudo nft add chain inet my_table my_input &#39;{ type filter hook input priority 0 ; policy drop ; }&#39;

sudo nft add rule filter input ip saddr { 0.0.0.0/0 } tcp dport { 22 } accept
</code></pre><p><a href=https://forum.linuxfoundation.org/discussion/473867/nftables-how-to-redirect-all-traffic-to-port-8080-to-another-ip target=_blank rel=noopener>Esta persona preguntó cómo hacer lo que yo quiero pero nadie ha respondido</a></p><pre tabindex=0><code>sudo nft add rule inet filter input tcp dport { ssh, http, https } accept
</code></pre><hr><p>Redirigir puerto: <a href=https://ungleich.ch/u/blog/nftables-magic-redirect-all-ports-to-one-port/ target=_blank rel=noopener>https://ungleich.ch/u/blog/nftables-magic-redirect-all-ports-to-one-port/</a></p><p><a href=https://chat.ungleich.ch/ target=_blank rel=noopener>Chat para infraestructura abierta</a></p></article></main></body></html>