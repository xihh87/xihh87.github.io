<!doctype html><html lang=es-mx><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Notas para Python</title><link rel=stylesheet media=screen href=https://joshua.haase.mx/css/theme.min.2ee1317322f9eb9b2ef0a618d19b20e38c11f5f9c310751400a45db225dd2626.css integrity="sha256-LuExcyL565su8KYY0Zsg44wR9fnDEHUUAKRdsiXdJiY="><script src=https://hypothes.is/embed.js></script></head><body><main><article><h1>Notas para Python</h1><nav id=TableOfContents><ul><li><a href=#usar-tipado-estático-opcionalmente-en-python>Usar tipado estático opcionalmente en python</a></li><li><a href=#generar-bibliotecas-en-python>Generar bibliotecas en python</a></li><li><a href=#documentar-bibliotecas-en-python>Documentar bibliotecas en python</a></li><li><a href=#se-puede-usar-la-documentación-para-verificar-el-funcionamiento-del-programa>Se puede usar la documentación para verificar el funcionamiento del programa</a></li><li><a href=#interfaces-en-python>Interfaces en python</a></li><li><a href=#generar-repositorio-privado>Generar repositorio privado</a></li><li><a href=#excepciones-en-python>Excepciones en python</a></li><li><a href=#gestionar-repositorio-de-pre-commit>Gestionar repositorio de pre-commit</a></li><li><a href=#gestor-de-paquetes>Gestor de paquetes</a></li></ul></nav><p><a href=https://blog.frank-mich.com/python-code-formatters-comparison-black-autopep8-and-yapf/ target=_blank rel=noopener><code>black</code> deja código uniforme y <code>autopep8</code> sólo corrige errores</a>
<a href=https://github.com/google/yapf/ target=_blank rel=noopener><code>yapf</code> tiene varias opciones</a>
y eso es una desventaja porque genera discusión,
además posiblemente no verifica AST.</p><p><a href=https://flake8.pycqa.org/en/latest/ target=_blank rel=noopener><code>flake8</code> verifica posibles problemas en el código</a>.</p><p><a href=https://github.com/pre-commit/pre-commit-hooks target=_blank rel=noopener>Todos los pre-commit-hooks disponibles</a>.</p><p>Configurar <code>flake8</code> para no pelearse con black</p><h2 id=usar-tipado-estático-opcionalmente-en-python><a href=#usar-tipado-est%c3%a1tico-opcionalmente-en-python alt>Usar tipado estático opcionalmente en python</a> <a href=# alt="Regresar al inicio">↑</a></h2><p>A partir de python 3.6 se puede usar una sintaxis <a href=https://peps.python.org/pep-0483/ title="gradual typing" target=_blank rel=noopener>opcional</a>
para <a href=https://realpython.com/python-type-checking/ target=_blank rel=noopener>verificar tipos de datos</a>:</p><pre tabindex=0><code>def funcion(var: tipo) -&gt; tipo:
    do_things()
</code></pre><p><a href=https://peps.python.org/pep-0484/ target=_blank rel=noopener>Los tipados en python se guardan como anotaciones
y el intérprete de python no los verifica</a>.</p><p>Se puede <a href=https://mypy.readthedocs.io/en/stable/index.html target=_blank rel=noopener>usar <code>mypy</code> para verificar los tipos de datos</a>,
<a href=https://mypy.readthedocs.io/en/stable/getting_started.html target=_blank rel=noopener>se usa como intérprete alternativo a <code>python</code></a>.</p><p><a href=https://www.digitalocean.com/community/tutorials/python-typing-module target=_blank rel=noopener>Los tipos de datos pueden salir del módulo <code>typing</code></a>.</p><h2 id=generar-bibliotecas-en-python><a href=#generar-bibliotecas-en-python alt>Generar bibliotecas en python</a> <a href=# alt="Regresar al inicio">↑</a></h2><p><a href=https://packaging.python.org/en/latest/ target=_blank rel=noopener>Instrucciones oficiales para empaquetar en python</a>:</p><ul><li><a href=https://packaging.python.org/en/latest/flow/ target=_blank rel=noopener>Generar un <code>pyproject.toml</code></a></li><li>Construir sdist y bdist</li></ul><p><a href=https://drivendata.co/blog/python-packaging-2023 target=_blank rel=noopener>Las nuevas bibliotecas usan pyproject</a>,
conviene conocer estos estándares:
<a href=https://peps.python.org/pep-0517/ title="A build-system independent format for source trees" target=_blank rel=noopener>PEP 517</a>,
<a href=https://peps.python.org/pep-0518/ title="Specifying Minimum Build System Requirements for Python Projects" target=_blank rel=noopener>PEP 518</a>,
<a href=https://peps.python.org/pep-0621/ title="Storing project metadata in pyproject.toml" target=_blank rel=noopener>PEP 621</a>, and
<a href=https://peps.python.org/pep-0660/ title="Editable installs for pyproject.toml based builds (wheel based)" target=_blank rel=noopener>PEP 660</a>.</p><p><a href=https://geekflare.com/create-python-packages/#h-best-practices-for-creating-python-packages target=_blank rel=noopener>Mejores prácticas para paquetes python</a>.</p><p><a href=https://medium.com/analytics-vidhya/how-to-create-a-python-library-7d5aea80cc3f target=_blank rel=noopener>Instructivo para generar paquetes que funciona pero usa <code>setup.py</code> que ya va de salida</a>.</p><p>Para subir bibliotecas a pip (<a href=/proyectos/2024-publicar-testing.mysql/>ejemplo</a>):</p><pre tabindex=0><code>twine check ${PROJECT_DIRECTORY}
twine check --strict ${PACKAGE}
</code></pre><h2 id=documentar-bibliotecas-en-python><a href=#documentar-bibliotecas-en-python alt>Documentar bibliotecas en python</a> <a href=# alt="Regresar al inicio">↑</a></h2><p>Se puede usar <a href=https://www.sphinx-doc.org/en/master/ target=_blank rel=noopener><code>sphinx</code></a>
(<a href=https://packaging.python.org/en/latest/tutorials/creating-documentation/ target=_blank rel=noopener>tutorial</a>),
<a href=https://docs.python.org/3/library/pydoc.html target=_blank rel=noopener><code>mkdocs](https://realpython.com/python-project-documentation-with-mkdocs/ ), [</code>pydoc`</a>.</p><p>Para buena documentación, conviene conocer las
<a href=https://peps.python.org/pep-0257/#multi-line-docstrings target=_blank rel=noopener>convenciones de las docstrings (PEP 257)</a>.</p><p><a href=https://packaging.python.org/en/latest/tutorials/creating-documentation/ target=_blank rel=noopener>En sphinx, usas <code>sphinx-quickstart</code>,
editas <code>index.rst</code> y
ejecutas <code>make html</code></a>.</p><hr><p><a href=https://drivendata.co/blog/python-packaging-2023 target=_blank rel=noopener>Buenas prácticas para empaquetar en python</a>.</p><hr><p><a href=https://realpython.com/fastapi-python-web-apis/ target=_blank rel=noopener>Tutorial de FastAPI</a>.</p><h2 id=se-puede-usar-la-documentación-para-verificar-el-funcionamiento-del-programa><a href=#se-puede-usar-la-documentaci%c3%b3n-para-verificar-el-funcionamiento-del-programa alt>Se puede usar la documentación para verificar el funcionamiento del programa</a> <a href=# alt="Regresar al inicio">↑</a></h2><p>El siguiente código se puede usar para hacer pruebas que verifiquen
que <a href=https://docs.python.org/3/library/doctest.html target=_blank rel=noopener>el código en la documentación funciona como se espera</a>:</p><pre tabindex=0><code>import doctest
doctest.testmod()
</code></pre><p><a href=https://google.github.io/styleguide/pyguide.html target=_blank rel=noopener>La guía de estilos que usa google para <code>python</code></a>.</p><h2 id=interfaces-en-python><a href=#interfaces-en-python alt>Interfaces en python</a> <a href=# alt="Regresar al inicio">↑</a></h2><p>Se pueden <a href=https://realpython.com/python-interface/ target=_blank rel=noopener>crear interfaces en python</a>
generando una clase abstracta
con <code>class MyInterface(metaclass=abc.ABCMeta):</code>,
que implementa métodos etiquetados como abstractos <code>@abc.abstracmethod</code>,
que levantan una excepción,
y agregando un <code>@classmethod</code> llamado <code>__subclasshook__</code>
que verifica que la implementaciones de los métodos existen.</p><p><a href=https://stackoverflow.com/a/51273196 target=_blank rel=noopener>Posiblemente sólo se necesita generar
una clase base con métodos abstractos</a>.</p><p><code>abc</code> → Abstrack Base Classes</p><p>También <a href=https://interface.readthedocs.io/en/latest/api-reference.html target=_blank rel=noopener>existe <code>python-interface</code></a>
que permite declarar <code>class Interfaz(interface.Interface)</code>
y declarar clases <code>class Implementacion(interface.implements(Interfaz))</code>
y las verifica al importar el módulo y no al crear la clase.</p><h2 id=generar-repositorio-privado><a href=#generar-repositorio-privado alt>Generar repositorio privado</a> <a href=# alt="Regresar al inicio">↑</a></h2><p>Se puede generar un repositorio usando
<a href=https://packaging.python.org/en/latest/guides/hosting-your-own-index/ target=_blank rel=noopener>un directorio por cada paquete que se quiera publicar</a>
usando <a href=https://packaging.python.org/en/latest/specifications/name-normalization/#name-normalization target=_blank rel=noopener>el nombre normalizado del proyecto</a>.</p><h2 id=excepciones-en-python><a href=#excepciones-en-python alt>Excepciones en python</a> <a href=# alt="Regresar al inicio">↑</a></h2><p><a href=https://docs.python.org/3/library/exceptions.html#concrete-exceptions target=_blank rel=noopener>Referencia de excepciones</a></p><p><a href=https://docs.python.org/3/using/cmdline.html#cmdoption-O target=_blank rel=noopener>Python desactiva las <em>assertions</em> cuando se usa optimización</a>.</p><p><a href=https://www.coursera.org/tutorials/python-exception-cheat-sheet#7-base-classes target=_blank rel=noopener>Las excepciones personalizadas se deben basar en <code>Exception</code> <del>no <code>BaseException</code></del></a>.</p><h2 id=gestionar-repositorio-de-pre-commit><a href=#gestionar-repositorio-de-pre-commit alt>Gestionar repositorio de pre-commit</a> <a href=# alt="Regresar al inicio">↑</a></h2><p><code>pre-commit</code> genera un directorio por cada sistema que utiliza,
que se puede encontrar revisando la base de datos.
por ejemplo, en mi caso para encontrar el repositorio de <code>mypy</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sqlite3 ~/.cache/pre-commit/db.db
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> path <span style=color:#66d9ef>from</span> repos <span style=color:#66d9ef>where</span> repo <span style=color:#66d9ef>like</span> <span style=color:#e6db74>&#39;%mypy&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>x<span style=color:#f92672>/</span>.<span style=color:#66d9ef>cache</span><span style=color:#f92672>/</span>pre<span style=color:#f92672>-</span><span style=color:#66d9ef>commit</span><span style=color:#f92672>/</span>repo3cf2hqcl
</span></span></code></pre></div><p>Luego entonces puedo instalar dependencias para que <code>mypy</code> pueda ejecutarse desde <code>pre-commit</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>REPO<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>. $REPO/py_env-python3.13/bin/activate
</span></span><span style=display:flex><span>python -m pip install  sqlalchemy
</span></span></code></pre></div><h2 id=gestor-de-paquetes><a href=#gestor-de-paquetes alt>Gestor de paquetes</a> <a href=# alt="Regresar al inicio">↑</a></h2><p><a href=https://docs.astral.sh/uv/ target=_blank rel=noopener><code>uv</code> es un gestor de paquetes para python escrito en Rust</a></p></article><section id=list><h2>Recursos</h2><ul class=contents></ul></section></main></body></html>