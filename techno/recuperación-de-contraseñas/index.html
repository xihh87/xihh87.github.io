<!doctype html><html lang=es-mx><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Recuperar la contraseña de una máquina virtual</title>
<link rel=stylesheet media=screen href=https://joshua.haase.mx/css/theme.min.2ee1317322f9eb9b2ef0a618d19b20e38c11f5f9c310751400a45db225dd2626.css integrity="sha256-LuExcyL565su8KYY0Zsg44wR9fnDEHUUAKRdsiXdJiY="><script src=https://hypothes.is/embed.js></script></head><body><main><article><h1>Recuperar la contraseña de una máquina virtual</h1><p>Si se tienen máquinas virtuales a las que no tienen acceso se puede reestablecer la contraseña accediendo a los discos virtuales.</p><ol class=example type=1><li>Apagar la máquina virtual.</li></ol><pre><code>xl list
xl shutdown [id]</code></pre><ol start=2 class=example type=1><li>Identificar el archivo donde está el sistema de archivos de la máquina virtual en su configuración.</li></ol><pre><code>VM=
CONFIG=/home/xen/$VM/conf/$VM.cfg
grep disk $CONFIG</code></pre><ol start=3 class=example type=1><li>Buscar el disco entre los dispositivos loop.</li></ol><pre><code># El archivo debería ser este, pero verificar:
FILE=/home/xen/$VM/disks/$VM.img
losetup -a | grep $FILE
# Completar la siguiente línea con el loop correcto si existe:
LOOP=/dev/loop</code></pre><pre><code>Si el disco se encuentra en esta lista, saltar al paso (@mount).</code></pre><ol start=4 class=example type=1><li>Si no está configurado como loop el archivo, agregarlo.</li></ol><pre><code>LOOP=&quot;$(losetup -f)&quot;
losetup ${LOOP} ${FILE}</code></pre><ol start=5 class=example type=1><li>Montar el dispositivo en un directorio.</li></ol><pre><code>DIRECTORY=/mnt
mount ${LOOP} ${DIRECTORY}</code></pre><ol start=6 class=example type=1><li>Cambiar la raíz hacia el directorio montado.</li></ol><pre><code>chroot ${DIRECTORY}</code></pre><ol start=7 class=example type=1><li>Verificar que estamos en el host correcto:</li></ol><pre><code>cat /etc/hostname</code></pre><ol start=8 class=example type=1><li>Cambiar la contraseña en el directorio.</li></ol><pre><code>passwd</code></pre><ol start=9 class=example type=1><li>Verificar que el cambio se realizó correctamente.</li></ol><pre><code>diff /etc/shadow- /etc/shadow
# sólo debería haber cambiado la línea de root</code></pre><ol start=10 class=example type=1><li>Salir del chroot y desmontar.</li></ol><pre><code>exit # para salir del chroot
umount ${DIRECTORY}</code></pre><ol start=11 class=example type=1><li>Si se realizó el paso (4), desactivar el loop que se configuró.</li></ol><pre><code>losetup -d ${LOOP}</code></pre><ol start=12 class=example type=1><li>Si ya terminamos de trabajar, limpiamos las variables.</li></ol><pre><code>unset VM CONFIG DIRECTORY FILE LOOP</code></pre><h2 id=contraseñas-por-fuerza-bruta>Contraseñas por fuerza bruta</h2><p>En ocasiones (espero no muy seguido) es importante recuperar una contraseña olvidada para acceder a cierta información.</p><p>Esto es equivalente al ataque fuera de línea para encontrar contraseñas.</p><p><a href=https://arstechnica.com/information-technology/2012/12/25-gpu-cluster-cracks-every-standard-windows-password-in-6-hours/>Los profesionales usan clústers de GPUs</a> para descifrar las contraseñas.</p><p><a href=https://systemoverlord.com/2021/06/05/gpu-accelerated-password-cracking-in-the-cloud.html>Este es un estimado de cuánto puede descifrar cada GPU</a></p><p><a href=https://contest-2021.korelogic.com/>Korelogic organiza un concurso anual de cracking de contraseñas</a>.</p><p>Estos ataques pueden escalarse, porque es mucho más eficiente crackear lotes de hashes que crackear pocos hashes.</p><p><a href=https://mchow01.github.io/education/security/2018/11/10/password-cracking.html>Ejemplos de un concurso de cibereguridad</a>.</p></article></main></body></html>