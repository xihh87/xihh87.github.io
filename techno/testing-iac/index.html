<!doctype html><html lang=es-mx><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Probar infraestructura como código</title><link rel=stylesheet media=screen href=https://joshua.haase.mx/css/theme.min.c631e12f4e2b4b8b5282c3d94590678b7a225e8caccee02c0d37dac1838d6a61.css integrity="sha256-xjHhL04rS4tSgsPZRZBni3oiXoyszuAsDTfawYONamE="><script src=https://hypothes.is/embed.js></script></head><body><main><article><h1>Probar infraestructura como código</h1><nav id=TableOfContents><ul><li><a href=#molecule>Molecule</a></li></ul></nav><p>Hice <a href=https://gitlab.com/xihh87/my-workstation/ target=_blank rel=noopener>un repositorio</a> con el que pretendía
no volver a configurar mi compu manualmente,
sin importar si uso alguno de estos sistemas operativos:</p><ul><li>Ubuntu LTS</li><li>Debian stable</li><li>Arch Linux</li><li>Alpine Linux</li></ul><p>Para verificar que funcionan,
instalé</p><h2 id=molecule><a href=#molecule alt>Molecule</a> <a href=# alt="Regresar al inicio">↑</a></h2><p>Este programa <a href=https://www.jeffgeerling.com/blog/2018/testing-your-ansible-roles-molecule target=_blank rel=noopener>sirve para verificar que los paquetes de Ansible funcionan correctamente</a></p><p>En general me ha funcionado bien,
y había usado <a href=../techno/systemd-docker.md>contenedores ejecutando <code>systemd</code></a>
para realizar la prueba de los sistemas.</p><pre tabindex=0><code>git clone git@gitlab.com:xihh87/my-workstation.git
cd my-workstation
mk start
. .venv/bin/activate
ansible-playbook -i ${SERVER}.yml
</code></pre><p>Sin embargo, ahora que <a href=https://github.com/hercules-ci/arion/issues/122#issue-913386120 title="Systemd and docker have become incompatible since 21.05 and cgroupsv2." target=_blank rel=noopener>&ldquo;docker y systemd están peleados&rdquo;</a></p><p>MOLECULE_DISTRO=debian10 molecule test # Fails</p><p><a href=http://giovannitorres.me/testing-ansible-roles-with-molecule-testinfra-and-vagrant.html target=_blank rel=noopener>Test Ansible roles on virtual machines using Vagrant and Testinfra</a></p><p><a href=https://zapier.com/engineering/ansible-molecule/ target=_blank rel=noopener>Test multiple distros on Ansible</a></p><p><a href=https://ruleoftech.com/2017/dockerizing-all-the-things-running-ansible-inside-docker-container target=_blank rel=noopener>Run Ansible inside alpine</a></p><p><a href=https://testinfra.readthedocs.io/en/latest/ target=_blank rel=noopener>Testinfra allows to check state on docker images or VM&rsquo;s and maybe on servers</a></p><h1 id=instalación-automática><a href=#instalaci%c3%b3n-autom%c3%a1tica alt>Instalación automática</a> <a href=# alt="Regresar al inicio">↑</a></h1><p><a href=https://github.com/binary-manu/arch-ansible target=_blank rel=noopener>Ansible para instalar Archlinux en otra computadora</a></p><p><a href=https://github.com/ansible-community/molecule/issues/942#issuecomment-582439431 target=_blank rel=noopener>Molecule está diseñado para probar roles individualmente</a></p><h1 id=búsqueda-de-paquetes><a href=#b%c3%basqueda-de-paquetes alt>Búsqueda de paquetes</a> <a href=# alt="Regresar al inicio">↑</a></h1><ul><li>Alpine: <a href=https://pkgs.alpinelinux.org/packages target=_blank rel=noopener>https://pkgs.alpinelinux.org/packages</a></li><li>Arch: <a href=https://www.archlinux.org/packages/ target=_blank rel=noopener>https://www.archlinux.org/packages/</a></li><li>Debian: <a href=https://www.debian.org/distrib/packages#search_contents target=_blank rel=noopener>https://www.debian.org/distrib/packages#search_contents</a></li><li>Ubuntu: <a href=https://packages.ubuntu.com/ target=_blank rel=noopener>https://packages.ubuntu.com/</a></li><li>PureOS: <a href=https://software.pureos.net/ target=_blank rel=noopener>https://software.pureos.net/</a></li></ul></article></main></body></html>