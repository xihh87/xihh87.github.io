<!doctype html><html lang=es-mx><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Entrenamiento en DevOps</title><link rel=stylesheet media=screen href=https://joshua.haase.mx/css/theme.min.c631e12f4e2b4b8b5282c3d94590678b7a225e8caccee02c0d37dac1838d6a61.css integrity="sha256-xjHhL04rS4tSgsPZRZBni3oiXoyszuAsDTfawYONamE="></head><body><main><article><h1>Entrenamiento en DevOps</h1><nav id=TableOfContents></nav><p>Si quisiera gestionar una infraestructura con software libre,
la gestionaría usando <a href=https://theforeman.org/ target=_blank rel=noopener>The Foreman</a>.</p><pre tabindex=0><code>$ sudo foreman-installer
forward DNS points to the host name which is not configured on the server.
your system does not meet config criteria.
</code></pre><p>Tuve que cambiar el nombre de mi host hacia 127.0.0.1 porque antes había configurado un nginx con sitios de prueba:</p><pre tabindex=0><code>$ hostname -f
onix.nomia.mx
$ sudo vis /etc/hosts
</code></pre><p>La instalación de foreman falló en mi laptop
¿porque <a href=https://tickets.puppetlabs.com/browse/SERVER-1665 target=_blank rel=noopener>necesita 4GB de RAM para funcionar</a>?</p><pre tabindex=0><code>-- Unit puppetserver.service has begun starting up.
sep 12 20:52:49 onyx puppetserver[11591]: Exception in thread &#34;main&#34; java.lang.ClassNotFoundException: javax.xml.ws.ProtocolException, compiling:(liberator/conneg.clj:1:1
sep 12 20:52:49 onyx puppetserver[11591]:         ... 328 more
sep 12 20:52:49 onyx puppetserver[11591]: Background process 11610 exited before start had completed
sep 12 20:52:49 onyx systemd[1]: puppetserver.service: Control process exited, code=exited status=1
sep 12 20:52:49 onyx systemd[1]: puppetserver.service: Failed with result &#39;exit-code&#39;.
sep 12 20:52:49 onyx systemd[1]: Failed to start puppetserver Service.
</code></pre><p>Parece que este error se muestra cuando intento iniciar pupetserver:</p><pre tabindex=0><code>sep 12 20:10:22 onyx systemd-resolved[12427]: Server returned error NXDOMAIN, mitigating potential DNS violation DVE-2018-0001, retrying transaction with reduced feature
sep 12 20:10:22 onyx systemd-resolved[12427]: Server returned error NXDOMAIN, mitigating potential DNS violation DVE-2018-0001, retrying transaction with reduced feature
sep 12 20:10:25 onyx sudo[30509]:       xu : TTY=pts/2 ; PWD=/home/xu ; USER=root ; COMMAND=/bin/ls -la /var/log/puppetlabs/puppetserver/
</code></pre><p>Desactivo <code>systemd-resolved</code> para intentar de nuevo:</p><pre tabindex=0><code>$ sudo systemctl stop systemd-resolved
$ sudo systemctl mask systemd-resolved
Created symlink /etc/systemd/system/systemd-resolved.service → /dev/null.
</code></pre><p>Tal vez no funciona por la configuración de mi computadora.
<del>¿Funcionará en un docker?</del> No se necesita.</p><p>El problema no es <a href=https://projects.theforeman.org/issues/19986 target=_blank rel=noopener>este</a></p><pre tabindex=0><code>$ sudo ls -la /etc/puppetlabs/puppet/ssl/
total 36
drwxrwx--x 8 puppet puppet 4096 sep 12 19:18 .
drwxr-xr-x 3 root   root   4096 sep 12 19:17 ..
drwxr-xr-x 5 puppet puppet 4096 sep 12 19:18 ca
drwxr-xr-x 2 puppet puppet 4096 sep 12 19:18 certificate_requests
drwxr-xr-x 2 puppet puppet 4096 sep 12 19:18 certs
-rw-r--r-- 1 puppet puppet  963 sep 12 19:18 crl.pem
drwxr-x--- 2 puppet puppet 4096 mar 12  2019 private
drwxr-x--- 2 puppet puppet 4096 mar 13  2019 private_keys
drwxr-xr-x 2 puppet puppet 4096 mar 13  2019 public_keys
</code></pre><p><a href=https://tickets.puppetlabs.com/browse/SERVER-2426 target=_blank rel=noopener>Desinstalar openjdk-11-jre-headless</a> funcionó para instalar el sistema exitosamente:</p><pre tabindex=0><code>$ sudo apt purge openjdk-11-jre-headless
$ sudo foreman-installer
Installing             Done                                               [100%] [.......................................................................................]
  Success!
  * Foreman is running at https://onyx.nomia.mx
      Initial credentials are admin / PASSWORD
  * Foreman Proxy is running at https://onyx.nomia.mx:8443
  * Puppetmaster is running at port 8140
  The full log is at /var/log/foreman-installer/foreman.log
</code></pre><h1 id=herramientas-para-aprovisionamiento-de-infraestructura><a href=#herramientas-para-aprovisionamiento-de-infraestructura alt>Herramientas para aprovisionamiento de infraestructura</a> <a href=# alt="Regresar al inicio">↑</a></h1><p><a href=https://devops.com/flap-part-1-server-provisioning/ target=_blank rel=noopener>Este post de DevOps.com</a> recomienda:</p><ul><li>clobber</li><li>foreman</li><li>MaaS</li><li>Razor</li><li>StackIQ</li></ul><h1 id=otros-recursos><a href=#otros-recursos alt>Otros recursos</a> <a href=# alt="Regresar al inicio">↑</a></h1><p><a href=http://www.admin-magazine.com/Archive/2013/14/Life-cycle-management-with-Foreman-and-Puppet target=_blank rel=noopener>http://www.admin-magazine.com/Archive/2013/14/Life-cycle-management-with-Foreman-and-Puppet</a></p></article></main></body></html>